# 🏠 관리비 자동 고지서 시스템

React + TypeScript + SQLite를 사용한 아파트/빌라 관리비 자동 계산 및 고지서 출력 시스템입니다.

## 🚀 **최신 업데이트! 기간별 고지서 표 형태 기능 추가**

- **🔥 완전 오프라인 작동** - 인터넷 연결 없이도 모든 기능 사용 가능!
- **💾 데이터 영구 저장** - 로컬스토리지 + 파일 백업/복원
- **🆕 기간별 고지서 (표 형태)** - 여러 월의 요금을 한눈에 비교!
- **🏠 호실 관리** - 호실 추가/편집/삭제 자유자재!
- **⚡ 통합 UI** - 검침값 입력부터 관리비 계산까지 한 화면에서!
- **🔧 자동 계산** - 공동관리비 = 전체관리비 - 전기료 - 수도료

## ✨ 주요 기능

### 🏠 호실 관리
- 호실 추가/편집/삭제 기능
- 호실명과 전용면적 설정
- 면적 비율 자동 계산
- 관련 검침 데이터 연동 삭제

### 📋💰 검침값 입력 & 관리비 계산 (통합)
- **검침값 입력**: 호실별 전기/수도 검침값 입력
- **이전 월 데이터**: 자동 표시 및 사용량 계산
- **관리비 계산**: 전체 관리비에서 전기료, 수도료를 뺀 공동관리비 자동 계산
- **분담 방식**: 
  - 전기료/수도료: 사용량 비례
  - 공동관리비: 면적 비례
- **실시간 계산**: 입력과 동시에 결과 확인

### 📄 고지서 출력 (업그레이드!)
- **단일 월 고지서**: 특정 월의 고지서 조회
- **🆕 기간별 고지서 (표 형태)**: 여러 월의 요금을 테이블로 한눈에 비교
- **호실 선택**: 특정 호실 또는 전체 호실 필터링
- **상세 사용량 내역**: 전월 대비 당월 사용량 표시
- **요금 내역 분석**: 전기료, 수도료, 공동관리비 분할 표시
- **최적화된 인쇄**: 브라우저 인쇄 기능으로 전문적인 고지서 출력

## 🚀 시작하기

### 설치 및 실행

```bash
# 의존성 설치
npm install

# 개발 서버 시작
npm run dev
```

### 📊 샘플 데이터 사용법

1. 애플리케이션 실행 후 **"📊 샘플 데이터 로드"** 버튼 클릭
2. 이미지 기반 2024년 1-2월 검침 데이터가 자동 입력됩니다
3. **"📋💰 검침값 & 관리비"** 탭에서 다음 값들을 입력:
   - 전체 관리비: 288,510원
   - 전체 전기료: 47,440원
   - 전체 수도료: 17,440원
   - ※ 공동관리비는 자동 계산됩니다 (223,630원)
4. **"관리비 계산하기"** 버튼 클릭
5. **"📄 고지서 출력"** 탭에서:
   - **단일 월**: 2024년 2월 고지서 확인
   - **🆕 기간별 (표 형태)**: 2024년 1월~2월 요금을 테이블로 비교 가능

## 📐 계산 방식

### 전기료 & 수도료 (사용량 비례)
```
개별 호실 요금 = (개별 사용량 / 전체 사용량) × 전체 요금
```

### 공동관리비 (자동 계산 후 면적 비례)
```
1. 공동관리비 = 전체 관리비 - 전체 전기료 - 전체 수도료
2. 개별 호실 공동관리비 = (개별 면적 / 전체 면적) × 공동관리비
```

## 🏗️ 시스템 구조

### 데이터베이스 스키마
- **units**: 호실 정보 (호실명, 면적)
- **meter_readings**: 검침 데이터 (호실, 연월, 전기/수도 검침값)
- **monthly_bills**: 월별 전체 요금
- **unit_bills**: 호실별 계산된 요금

### 기술 스택
- **Frontend**: React 19, TypeScript, Material-UI
- **Database**: SQLite (sql.js - 브라우저용)
- **Build**: Vite
- **Styling**: Material-UI, Emotion

## 📱 사용 흐름

1. **호실 관리** → 2. **검침값 입력 & 관리비 계산** → 3. **고지서 출력**

### 1단계: 호실 관리
- 호실 추가 (호실 ID, 호실명, 전용면적)
- 기존 호실 정보 수정
- 불필요한 호실 삭제

### 2단계: 검침값 입력 & 관리비 계산 (통합)
- **연도/월 선택**
- **검침값 입력**: 각 호실의 전기/수도 검침값 입력
- **사용량 확인**: 이전 월 대비 실시간 사용량 계산
- **관리비 입력**: 전체 관리비, 전기료, 수도료 입력
- **공동관리비 자동 계산**: 전체관리비 - 전기료 - 수도료
- **관리비 계산**: 사용량과 면적 비례로 자동 분할
- **결과 확인**: 호실별 계산 결과 테이블 표시

### 3단계: 고지서 출력 (업그레이드!)
- **단일 월 고지서**: 특정 년월과 호실 선택하여 조회
- **🆕 기간별 고지서 (표 형태)**: 시작 년월~끝 년월 설정하여 테이블로 출력
  - **전체 호실**: 각 호실별로 월별 요금 테이블 표시 + 기간 합계
  - **특정 호실**: 해당 호실의 월별 요금 + 평균/합계 + 사용량 상세
  - 예: 2024년 1월~12월 601A호 연간 요금 분석
- **호실 필터링**: 전체 또는 특정 호실만 선택 가능
- **상세 사용량**: 전월 대비 당월 사용량 및 요금 분석
- **최적화된 인쇄**: 페이지 구분된 전문적인 고지서 레이아웃

## 🔧 커스터마이징

### 호실 정보 변경
`src/database/Database.ts`의 `insertDefaultData()` 함수에서 호실 정보 수정:

```typescript
this.db.exec(`
  INSERT OR REPLACE INTO units (id, name, area) VALUES 
  ('101', '101호', 84.0),
  ('102', '102호', 84.0),
  ('201', '201호', 84.0)
`);
```

### 면적 단위 변경
현재 m² 기준으로 되어 있으며, 평수로 변경하려면 관련 컴포넌트의 표시 단위를 수정하면 됩니다.

## 📊 이미지 예시 데이터

제공된 이미지를 기반으로 한 실제 데이터:
- **601A호**: 60m², 전기 200KWH 사용, 수도 3.66m³ 사용
- **601B호**: 120m², 전기 99KWH 사용, 수도 3.66m³ 사용
- **전체 요금**: 관리비 288,510원, 전기료 47,440원, 수도료 17,440원
- **공동관리비**: 223,630원 (자동 계산)

## 📊 **기간별 고지서 표 형태의 장점**

### ✨ **혁신적인 테이블 방식**
- **한눈에 비교**: 여러 월의 요금을 테이블로 나란히 비교
- **자동 계산**: 기간 합계와 평균 자동 계산  
- **상세 분석**: 호실별 월별 트렌드 분석 가능
- **효율적 출력**: 긴 고지서 대신 컴팩트한 테이블
- **🆕 간소화된 검침 내역**: 전월 표시 제거로 더욱 깔끔한 화면

### 🔍 **전체 호실 모드**
각 호실별로 월별 요금 테이블을 표시하고 기간 합계를 자동 계산합니다.

### 🏠 **특정 호실 모드**  
선택한 호실의 상세 분석을 제공합니다:
- **월별 요금 테이블**: 전기료, 수도료, 공동관리비, 합계
- **평균/합계 계산**: 기간 평균과 총 합계 자동 계산
- **📊 검침 상세 내역**: 당월 검침값과 사용량을 깔끔하게 표시

### 💡 **실제 활용 예시**
```
📋 연간 정산: 2024년 1월~12월 전체 호실 요금 비교
📋 분기별 분석: 1분기 vs 2분기 요금 변화 추이  
📋 특정 호실 이력: 601A호 6개월간 사용량 패턴 분석
📋 세무 자료: 연간 관리비 납부 내역 테이블로 정리
```

## 🎯 추후 개선사항

- [ ] 연체료 계산 기능
- [ ] 관리비 항목별 세분화
- [ ] 월별 통계 및 차트
- [ ] 데이터 백업/복구 기능
- [ ] 엑셀 내보내기 기능
- [ ] 모바일 반응형 개선

## 📞 문의

시스템 사용 중 문제가 발생하거나 기능 개선이 필요한 경우 이슈를 등록해주세요.
